

## Add Google and Apple OAuth Sign-In

### Overview

Add "Continue with Google" and "Sign in with Apple" buttons to the Auth page. Both use Lovable Cloud's managed OAuth - no API keys or configuration needed.

---

### Changes

#### 1. Configure Social Auth

Run the `configure-social-auth` tool to generate the `src/integrations/lovable/` module with the auth helper.

---

#### 2. Update Auth.tsx

**New import:**
```typescript
import { lovable } from "@/integrations/lovable/index";
```

**New state:**
```typescript
const [isGoogleLoading, setIsGoogleLoading] = useState(false);
const [isAppleLoading, setIsAppleLoading] = useState(false);
```

**New handlers:**
```typescript
const handleGoogleSignIn = async () => {
  setIsGoogleLoading(true);
  setErrorMessage(null);
  const { error } = await lovable.auth.signInWithOAuth("google", {
    redirect_uri: window.location.origin,
  });
  if (error) {
    setErrorMessage("Google sign-in failed. Please try again.");
    setIsGoogleLoading(false);
  }
};

const handleAppleSignIn = async () => {
  setIsAppleLoading(true);
  setErrorMessage(null);
  const { error } = await lovable.auth.signInWithOAuth("apple", {
    redirect_uri: window.location.origin,
  });
  if (error) {
    setErrorMessage("Apple sign-in failed. Please try again.");
    setIsAppleLoading(false);
  }
};
```

**New UI elements (after the email/password form, before the toggle links):**

```tsx
{/* Divider */}
<div className="relative my-4">
  <div className="absolute inset-0 flex items-center">
    <span className="w-full border-t" />
  </div>
  <div className="relative flex justify-center text-xs uppercase">
    <span className="bg-card px-2 text-muted-foreground">or</span>
  </div>
</div>

{/* OAuth buttons */}
<div className="space-y-2">
  <Button variant="outline" className="w-full" onClick={handleGoogleSignIn} disabled={...}>
    <GoogleIcon /> Continue with Google
  </Button>
  <Button variant="outline" className="w-full" onClick={handleAppleSignIn} disabled={...}>
    <AppleIcon /> Sign in with Apple
  </Button>
</div>
```

---

### Visual Layout

```text
┌─────────────────────────────────┐
│         [App Logo]              │
│         App Name                │
│                                 │
│  Email: [___________________]   │
│  Password: [________________]   │
│                                 │
│  [        Sign In           ]   │
│                                 │
│  ─────────── or ───────────     │
│                                 │
│  [ G  Continue with Google  ]   │
│  [   Sign in with Apple    ]   │
│                                 │
│  Don't have an account? Sign Up │
│  Or try the demo                │
└─────────────────────────────────┘
```

---

### How It Works

1. User clicks either OAuth button
2. Redirects to Google/Apple's consent screen
3. User authenticates
4. Redirects back to app
5. **New user**: `handle_new_user()` trigger creates profile (same as email signup)
6. **Existing user with same email**: Accounts linked automatically

---

### Files Changed

| File | Change |
|------|--------|
| `src/integrations/lovable/` | Generated by configure-social-auth tool |
| `src/pages/Auth.tsx` | Add OAuth buttons, handlers, and divider |

---

### No Database Changes

Existing schema handles both providers identically to email auth.

